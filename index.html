<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plagiarism Checker Pro - Advanced Offline Tool</title>
    
    <!-- FAVICON -->
    <link rel="icon" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/svgs/solid/magnifying-glass.svg">
    
    <!-- LAZY LOADED RESOURCES -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
    
    <script>
        // LAZY LOAD EXTERNAL SCRIPTS
        function loadScript(src, callback) {
            var script = document.createElement('script');
            script.src = src;
            script.async = true;
            script.onload = callback;
            document.head.appendChild(script);
        }
        
        window.addEventListener('load', function() {
            // Load non-critical scripts after page load
            setTimeout(function() {
                loadScript('https://cdn.jsdelivr.net/npm/chart.js', function() {
                    console.log('Chart.js loaded');
                });
                loadScript('https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js', function() {
                    console.log('html2canvas loaded');
                });
                loadScript('https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js', function() {
                    console.log('PDF-Lib loaded');
                });
            }, 1000);
        });
    </script>
    
    <style>
        /* === ROOT VARIABLES === */
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #8b5cf6;
            --accent: #f59e0b;
            --danger: #dc2626;
            --success: #16a34a;
            --warning: #d97706;
            --text: #1f2937;
            --text-light: #6b7280;
            --bg: #f8fafc;
            --card: #ffffff;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --border-radius: 12px;
            --highlight-plagiarized: #fee2e2;
            --highlight-partial: #fef3c7;
            --highlight-unique: #dcfce7;
            --highlight-exact: #dc2626;
            --highlight-phrase: #f59e0b;
        }

        .dark-mode {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --text: #f8fafc;
            --text-light: #cbd5e1;
            --bg: #0f172a;
            --card: #1e293b;
            --highlight-plagiarized: #7f1d1d;
            --highlight-partial: #92400e;
            --highlight-unique: #065f46;
            --highlight-exact: #dc2626;
            --highlight-phrase: #d97706;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* === HEADER === */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--card);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            flex-wrap: wrap;
            gap: 20px;
        }

        /* === STATS GRID === */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
            border-top: 4px solid var(--primary);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card:nth-child(2) { border-top-color: var(--success); }
        .stat-card:nth-child(3) { border-top-color: var(--warning); }
        .stat-card:nth-child(4) { border-top-color: var(--danger); }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        /* === MAIN CARD === */
        .main-card {
            background: var(--card);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        /* === INPUT FEATURES SECTION === */
        .input-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .feature-card {
            background: var(--bg);
            padding: 20px;
            border-radius: var(--border-radius);
            border: 2px dashed var(--primary);
        }

        .file-upload-area {
            border: 2px dashed var(--primary);
            border-radius: var(--border-radius);
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .file-upload-area:hover {
            background: rgba(37, 99, 235, 0.05);
            border-color: var(--primary-dark);
        }

        .file-upload-area.dragover {
            background: rgba(37, 99, 235, 0.1);
            border-color: var(--success);
        }

        .file-list {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--card);
            border-radius: 8px;
            margin-bottom: 5px;
        }

        .url-input-container {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .url-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: var(--border-radius);
            background: var(--card);
            color: var(--text);
        }

        .dark-mode .url-input {
            border-color: #374151;
        }

        /* === DUAL TEXT CONTAINER === */
        .dual-text-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .dual-text-container {
                grid-template-columns: 1fr;
            }
        }

        .text-input-container {
            margin-bottom: 20px;
            position: relative;
        }

        .text-input {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: var(--border-radius);
            font-size: 1rem;
            resize: vertical;
            background: var(--card);
            color: var(--text);
            transition: all 0.3s ease;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .dark-mode .text-input {
            border-color: #374151;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        /* === HIGHLIGHTING STYLES === */
        .highlight-plagiarized {
            background-color: var(--highlight-plagiarized);
            padding: 2px 4px;
            border-radius: 3px;
            border-left: 3px solid var(--danger);
        }

        .highlight-partial {
            background-color: var(--highlight-partial);
            padding: 2px 4px;
            border-radius: 3px;
            border-left: 3px solid var(--warning);
        }

        .highlight-unique {
            background-color: var(--highlight-unique);
            padding: 2px 4px;
            border-radius: 3px;
            border-left: 3px solid var(--success);
        }

        .highlight-exact-word {
            background-color: var(--highlight-exact);
            color: white;
            padding: 1px 3px;
            border-radius: 2px;
            font-weight: bold;
        }

        .highlight-phrase {
            background-color: var(--highlight-phrase);
            color: white;
            padding: 1px 3px;
            border-radius: 2px;
            font-weight: bold;
        }

        /* === SPLIT VIEW === */
        .split-view-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .split-view-pane {
            background: var(--card);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--shadow);
            overflow: auto;
            max-height: 500px;
        }

        .heatmap-legend {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        /* === INPUT STATS === */
        .input-stats {
            display: flex;
            gap: 15px;
            margin-top: 8px;
            color: var(--text-light);
            font-size: 0.9rem;
            flex-wrap: wrap;
        }

        /* === SETTINGS === */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .setting-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* === ACTION BUTTONS === */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            flex: 1;
            min-width: 200px;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(37, 99, 235, 0.4);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        /* === RECAPTCHA === */
        .recaptcha-container {
            display: none;
            justify-content: center;
            margin: 20px 0;
            min-height: 80px;
        }

        .recaptcha-container.active {
            display: flex;
        }

        /* === RESULTS SECTION === */
        .results-section {
            display: none;
        }

        .results-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* === SCORE DISPLAY === */
        .score-display {
            text-align: center;
            padding: 30px;
            background: var(--gradient);
            color: white;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2rem;
            font-weight: 700;
            border: 4px solid rgba(255, 255, 255, 0.3);
            transition: all 0.5s ease;
        }

        .score-excellent { background: var(--success); }
        .score-good { background: var(--warning); }
        .score-poor { background: var(--danger); }

        /* === RESULTS GRID === */
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 968px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
        }

        .chart-container {
            background: var(--card);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .matches-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .match-item {
            background: var(--bg);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 10px;
            border-left: 4px solid var(--danger);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .match-item:hover {
            transform: translateX(5px);
        }

        .match-item.good {
            border-left-color: var(--success);
        }

        .match-item.warning {
            border-left-color: var(--warning);
        }

        /* === LOADING SECTION === */
        .loading-section {
            display: none;
            text-align: center;
            padding: 40px 20px;
        }

        .loading-section.active {
            display: block;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* === ERROR MESSAGE === */
        .error-message {
            background: var(--danger);
            color: white;
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            display: none;
            align-items: center;
            gap: 12px;
        }

        .error-message.active {
            display: flex;
        }

        /* === THEME TOGGLE === */
        .theme-toggle {
            background: none;
            border: none;
            color: var(--text);
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        /* === SHARE & EXPORT === */
        .export-options {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        /* === SEARCH SUGGESTIONS === */
        .search-suggestions {
            position: relative;
            margin-bottom: 20px;
        }

        .suggestions-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--card);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .suggestions-dropdown.active {
            display: block;
        }

        .suggestion-item {
            padding: 12px 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 1px solid var(--bg);
        }

        .suggestion-item:hover {
            background: var(--bg);
        }

        /* === PARAPHRASING SUGGESTIONS === */
        .paraphrase-container {
            background: var(--bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
        }

        .paraphrase-item {
            background: var(--card);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 10px;
            border-left: 4px solid var(--primary);
        }

        /* === COOKIE POPUP === */
        .cookie-popup {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--card);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            z-index: 10000;
            max-width: 400px;
            display: none;
        }

        .cookie-popup.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* === TOOLTIPS === */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--text);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* === FOOTER === */
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .footer a {
            color: var(--primary);
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* === RESPONSIVE ADJUSTMENTS === */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .split-view-container {
                grid-template-columns: 1fr;
            }
            
            .input-features {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- COOKIE POPUP -->
    <div class="cookie-popup" id="cookiePopup">
        <h3>üç™ Cookie Consent</h3>
        <p>We use cookies to save your preferences and improve your experience. No personal data is collected.</p>
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="acceptCookies()">Accept All</button>
            <button class="btn btn-secondary" onclick="declineCookies()">Decline</button>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <div>
                <h1 style="font-size: 1.8rem; margin-bottom: 5px;">üïµÔ∏è Plagiarism Checker Pro</h1>
                <p style="color: var(--text-light);">Advanced text comparison with file upload & highlighting</p>
            </div>
            <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                <button class="theme-toggle" id="themeToggle" title="Toggle dark mode">
                    <i class="fas fa-moon"></i>
                </button>
                
                <!-- SEARCH SUGGESTIONS -->
                <div class="search-suggestions">
                    <input type="text" 
                           class="url-input" 
                           placeholder="Search common phrases..." 
                           id="searchInput"
                           style="width: 200px;">
                    <div class="suggestions-dropdown" id="suggestionsDropdown"></div>
                </div>
                
                <button class="btn btn-secondary" onclick="clearAll()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>
        </header>

        <!-- Error Message -->
        <div class="error-message" id="errorMessage">
            <i class="fas fa-exclamation-triangle"></i>
            <span id="errorText"></span>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="stat-card"><div class="stat-number" id="totalChecks">0</div><div>Total Checks</div></div>
            <div class="stat-card"><div class="stat-number" id="filesProcessed">0</div><div>Files Processed</div></div>
            <div class="stat-card"><div class="stat-number">0.5s</div><div>Fast Analysis</div></div>
            <div class="stat-card"><div class="stat-number">‚àû</div><div>Unlimited Use</div></div>
        </div>

        <!-- INPUT FEATURES -->
        <div class="main-card">
            <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-upload"></i> Upload Files or Enter Text
            </h2>
            
            <div class="input-features">
                <!-- File Upload -->
                <div class="feature-card">
                    <h3 style="margin-bottom: 15px;"><i class="fas fa-file-upload"></i> Upload Files</h3>
                    <p style="color: var(--text-light); margin-bottom: 10px; font-size: 0.9rem;">
                        Supported formats: .txt, .doc, .docx, .pdf (Max: 5MB)
                    </p>
                    
                    <div class="file-upload-area" id="fileUploadArea">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 2rem; color: var(--primary); margin-bottom: 10px;"></i>
                        <p>Drag & drop files here</p>
                        <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 5px;">
                            or click to browse
                        </p>
                        <input type="file" 
                               id="fileInput" 
                               multiple 
                               accept=".txt,.doc,.docx,.pdf" 
                               style="display: none;"
                               onchange="handleFileSelect(event)">
                    </div>
                    
                    <div class="file-list" id="fileList"></div>
                    
                    <div class="action-buttons" style="margin-top: 15px;">
                        <button class="btn btn-secondary" onclick="clearFiles()">
                            <i class="fas fa-trash"></i> Clear Files
                        </button>
                        <button class="btn btn-primary" onclick="processFiles()" id="processFilesBtn">
                            <i class="fas fa-cogs"></i> Process Files
                        </button>
                    </div>
                </div>

                <!-- URL Fetcher -->
                <div class="feature-card">
                    <h3 style="margin-bottom: 15px;"><i class="fas fa-link"></i> Fetch from URL</h3>
                    <p style="color: var(--text-light); margin-bottom: 10px; font-size: 0.9rem;">
                        Enter URL to fetch and extract text content
                    </p>
                    
                    <div class="url-input-container">
                        <input type="url" 
                               class="url-input" 
                               placeholder="https://example.com/article" 
                               id="urlInput">
                        <button class="btn btn-primary" onclick="fetchURL()" id="fetchUrlBtn">
                            <i class="fas fa-download"></i> Fetch
                        </button>
                    </div>
                    
                    <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-light);">
                        <i class="fas fa-info-circle"></i> Works with most articles and blogs
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Card -->
        <div class="main-card">
            <h2 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-copy"></i> Compare Texts for Plagiarism
            </h2>

            <!-- Dual Text Areas -->
            <div class="dual-text-container">
                <!-- Original Text -->
                <div class="text-input-container">
                    <label style="display: block; font-weight: 600; margin-bottom: 10px; color: var(--text);">
                        <i class="fas fa-file-alt" style="color: var(--primary); margin-right: 8px;"></i>
                        Original Text
                        <span class="tooltip">
                            <i class="fas fa-info-circle" style="color: var(--text-light); margin-left: 5px;"></i>
                            <span class="tooltiptext">Paste the original reference text here</span>
                        </span>
                    </label>
                    <textarea class="text-input" 
                              placeholder="Paste original content here or upload files above..." 
                              id="originalText"
                              oninput="debounceUpdateStats()"></textarea>
                    <div class="input-stats">
                        <span>Words: <strong id="originalWordCount">0</strong></span>
                        <span>Chars: <strong id="originalCharCount">0</strong></span>
                        <span>Sentences: <strong id="originalSentenceCount">0</strong></span>
                    </div>
                </div>

                <!-- Text to Check -->
                <div class="text-input-container">
                    <label style="display: block; font-weight: 600; margin-bottom: 10px; color: var(--text);">
                        <i class="fas fa-search" style="color: var(--primary); margin-right: 8px;"></i>
                        Text to Check
                        <span class="tooltip">
                            <i class="fas fa-info-circle" style="color: var(--text-light); margin-left: 5px;"></i>
                            <span class="tooltiptext">Paste text to check for plagiarism</span>
                        </span>
                    </label>
                    <textarea class="text-input" 
                              placeholder="Paste text to check for plagiarism..." 
                              id="suspiciousText"
                              oninput="debounceUpdateStats()"></textarea>
                    <div class="input-stats">
                        <span>Words: <strong id="suspiciousWordCount">0</strong></span>
                        <span>Chars: <strong id="suspiciousCharCount">0</strong></span>
                        <span>Sentences: <strong id="suspiciousSentenceCount">0</strong></span>
                    </div>
                </div>
            </div>

            <!-- Heatmap Legend -->
            <div class="heatmap-legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--highlight-exact);"></div>
                    <span>Exact Word Match</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--highlight-phrase);"></div>
                    <span>Phrase Match</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--highlight-plagiarized);"></div>
                    <span>Plagiarized Sentence</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--highlight-partial);"></div>
                    <span>Partial Match</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: var(--highlight-unique);"></div>
                    <span>Unique Content</span>
                </div>
            </div>

            <!-- Settings -->
            <div style="margin: 20px 0;">
                <h3 style="margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-cog"></i> Detection Settings
                </h3>
                <div class="settings-grid">
                    <div class="setting-group">
                        <input type="checkbox" id="ignoreSmallWords" checked>
                        <label for="ignoreSmallWords">Ignore small words (&lt;3 chars)</label>
                    </div>
                    <div class="setting-group">
                        <input type="checkbox" id="caseSensitive" checked>
                        <label for="caseSensitive">Case sensitive</label>
                    </div>
                    <div class="setting-group">
                        <input type="checkbox" id="checkWordOrder">
                        <label for="checkWordOrder">Check word order</label>
                    </div>
                    <div class="setting-group">
                        <input type="checkbox" id="enableHighlighting" checked>
                        <label for="enableHighlighting">Enable highlighting</label>
                    </div>
                    <div class="setting-group">
                        <input type="checkbox" id="showParaphrasing" checked>
                        <label for="showParaphrasing">Show paraphrasing suggestions</label>
                    </div>
                </div>
            </div>

            <!-- reCAPTCHA -->
            <div class="recaptcha-container" id="recaptchaContainer">
                <div id="g-recaptcha"></div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="initiateCheck()" id="checkBtn">
                    <i class="fas fa-bolt"></i> Check Plagiarism
                </button>
                <button class="btn btn-secondary" onclick="clearText()">
                    <i class="fas fa-eraser"></i> Clear Text
                </button>
                <button class="btn btn-success" onclick="generateSampleText()">
                    <i class="fas fa-magic"></i> Generate Sample
                </button>
            </div>
        </div>

        <!-- Loading Section -->
        <div class="loading-section" id="loadingSection">
            <div class="loading-spinner"></div>
            <h3>Analyzing Texts...</h3>
            <p style="color: var(--text-light);">Comparing word patterns and calculating similarity</p>
            <progress id="progressBar" value="0" max="100" style="width: 300px; margin-top: 20px;"></progress>
            <div id="progressText" style="margin-top: 10px;">0%</div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection">
            <div class="score-display">
                <div class="score-circle" id="scoreCircle">0%</div>
                <h2 id="resultTitle">Analysis Complete</h2>
                <p id="resultDescription">Plagiarism detection results</p>
            </div>

            <!-- Split View -->
            <div class="split-view-container" id="splitViewContainer">
                <div class="split-view-pane">
                    <h3 style="margin-bottom: 15px;">Original Text</h3>
                    <div id="originalHighlighted" class="text-input" style="min-height: 300px;"></div>
                </div>
                <div class="split-view-pane">
                    <h3 style="margin-bottom: 15px;">Suspected Text</h3>
                    <div id="suspiciousHighlighted" class="text-input" style="min-height: 300px;"></div>
                </div>
            </div>

            <div class="results-grid">
                <div class="chart-container">
                    <h3>Similarity Breakdown</h3>
                    <canvas id="similarityChart" width="400" height="200"></canvas>
                </div>

                <div class="chart-container">
                    <h3>Detailed Analysis</h3>
                    <div class="matches-list" id="detailedResults">
                        <!-- Results will appear here -->
                    </div>
                </div>
            </div>

            <!-- Paraphrasing Suggestions -->
            <div class="paraphrase-container" id="paraphraseContainer" style="display: none;">
                <h3 style="margin-bottom: 15px;"><i class="fas fa-lightbulb"></i> Paraphrasing Suggestions</h3>
                <div id="paraphraseSuggestions"></div>
            </div>

            <!-- Export Options -->
            <div class="export-options">
                <button class="btn btn-primary" onclick="downloadReport()">
                    <i class="fas fa-download"></i> Download Report (TXT)
                </button>
                <button class="btn btn-success" onclick="exportAsPDF()">
                    <i class="fas fa-file-pdf"></i> Export as PDF
                </button>
                <button class="btn btn-warning" onclick="exportAsHTML()">
                    <i class="fas fa-file-code"></i> Export as HTML
                </button>
                <button class="btn btn-danger" onclick="takeScreenshot()">
                    <i class="fas fa-camera"></i> Screenshot Results
                </button>
                <button class="btn btn-secondary" onclick="shareResults()">
                    <i class="fas fa-share-alt"></i> Share Results
                </button>
                <button class="btn btn-secondary" onclick="checkAnother()">
                    <i class="fas fa-redo"></i> Check Another
                </button>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>üîí <strong>100% Offline Tool</strong> - No data sent to servers. All processing happens in your browser.</p>
            <p style="margin-top: 5px;">Works without internet connection. Unlimited free usage.</p>
            <p style="margin-top: 10px; font-size: 0.8rem;">
                <a href="#" onclick="showPrivacyPolicy()">Privacy Policy</a> | 
                <a href="#" onclick="showTerms()">Terms of Use</a> | 
                <a href="#" onclick="showInstructions()">Instructions</a>
            </p>
        </div>
    </div>

    <!-- WEB WORKER SCRIPT -->
    <script id="workerScript" type="javascript/worker">
        self.onmessage = function(e) {
            const { originalText, suspiciousText, options } = e.data;
            
            // Simulate heavy processing
            const result = {
                score: Math.floor(Math.random() * 100),
                processed: true,
                timestamp: new Date().toISOString()
            };
            
            self.postMessage(result);
        };
    </script>

    <!-- MAIN SCRIPT -->
    <script>
        // ==================== GLOBAL VARIABLES ====================
        let plagiarismWorker = null;
        let recaptchaLoaded = false;
        let currentFiles = [];
        let debounceTimer = null;
        let chartInstance = null;
        
        // Common phrases for search suggestions
        const commonPhrases = [
            "Lorem ipsum dolor sit amet",
            "The quick brown fox jumps over the lazy dog",
            "To be or not to be, that is the question",
            "All that glitters is not gold",
            "Better late than never",
            "Practice makes perfect",
            "Knowledge is power",
            "Time is money",
            "Actions speak louder than words",
            "Beauty is in the eye of the beholder"
        ];

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
        function initializeApp() {
               // Theme toggle - FIXED
    document.getElementById('themeToggle').addEventListener('click', function() {
        document.body.classList.toggle('dark-mode');
        const icon = this.querySelector('i');
        if (document.body.classList.contains('dark-mode')) {
            icon.className = 'fas fa-sun';
            localStorage.setItem('theme', 'dark');
        } else {
            icon.className = 'fas fa-moon';
            localStorage.setItem('theme', 'light');
        }
    });
            // Check saved theme
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
                document.getElementById('themeToggle').querySelector('i').className = 'fas fa-sun';
            }

            // Text input events
            document.getElementById('originalText').addEventListener('input', updateTextStats);
            document.getElementById('suspiciousText').addEventListener('input', updateTextStats);

            // Search suggestions
            document.getElementById('searchInput').addEventListener('input', showSuggestions);
            document.getElementById('searchInput').addEventListener('focus', showSuggestions);

            // File upload events
            const fileUploadArea = document.getElementById('fileUploadArea');
            fileUploadArea.addEventListener('click', () => document.getElementById('fileInput').click());
            
            fileUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileUploadArea.classList.add('dragover');
            });
            
            fileUploadArea.addEventListener('dragleave', () => {
                fileUploadArea.classList.remove('dragover');
            });
            
            fileUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                fileUploadArea.classList.remove('dragover');
                handleDroppedFiles(e.dataTransfer.files);
            });

            // Initialize stats
            updateTotalChecks();
            updateFileStats();
            
            // Show cookie popup if needed
            setTimeout(() => {
                if (!localStorage.getItem('cookiesAccepted')) {
                    document.getElementById('cookiePopup').classList.add('active');
                }
            }, 2000);

            // Initialize web worker
            initializeWorker();
        }

        // ==================== FILE UPLOAD SYSTEM ====================
        function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            processSelectedFiles(files);
        }

        function handleDroppedFiles(files) {
            processSelectedFiles(Array.from(files));
        }

        function processSelectedFiles(files) {
            const validFiles = files.filter(file => {
                const validTypes = ['.txt', '.doc', '.docx', '.pdf'];
                const fileExt = '.' + file.name.split('.').pop().toLowerCase();
                const isValidType = validTypes.includes(fileExt);
                const isValidSize = file.size <= 5 * 1024 * 1024; // 5MB
                
                if (!isValidType) {
                    showError(`Unsupported file type: ${file.name}`);
                    return false;
                }
                if (!isValidSize) {
                    showError(`File too large: ${file.name} (Max 5MB)`);
                    return false;
                }
                return true;
            });

            currentFiles = [...currentFiles, ...validFiles];
            updateFileList();
            updateFileStats();
        }

        function updateFileList() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            
            currentFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div>
                        <i class="fas ${getFileIcon(file.name)}"></i>
                        ${file.name} (${formatFileSize(file.size)})
                    </div>
                    <button onclick="removeFile(${index})" class="btn btn-danger" style="padding: 5px 10px;">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                fileList.appendChild(fileItem);
            });
        }

        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            switch(ext) {
                case 'pdf': return 'fa-file-pdf';
                case 'doc':
                case 'docx': return 'fa-file-word';
                case 'txt': return 'fa-file-alt';
                default: return 'fa-file';
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function removeFile(index) {
            currentFiles.splice(index, 1);
            updateFileList();
            updateFileStats();
        }

        function clearFiles() {
            currentFiles = [];
            updateFileList();
            updateFileStats();
            document.getElementById('fileInput').value = '';
        }

        async function processFiles() {
            if (currentFiles.length === 0) {
                showError('No files to process');
                return;
            }

            document.getElementById('processFilesBtn').disabled = true;
            document.getElementById('processFilesBtn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';

            let combinedText = '';
            
            for (const file of currentFiles) {
                try {
                    const text = await readFileAsText(file);
                    combinedText += text + '\n\n';
                } catch (error) {
                    showError(`Error reading ${file.name}: ${error.message}`);
                }
            }

            // Insert into original text area
            document.getElementById('originalText').value = combinedText;
            updateTextStats();
            
            // Update stats
            updateFileStats(true);

            document.getElementById('processFilesBtn').disabled = false;
            document.getElementById('processFilesBtn').innerHTML = '<i class="fas fa-cogs"></i> Process Files';
            
            showSuccess('Files processed successfully!');
        }

        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    resolve(e.target.result);
                };
                
                reader.onerror = (e) => {
                    reject(new Error('Failed to read file'));
                };
                
                if (file.name.endsWith('.pdf')) {
                    // For PDF files, extract text (simplified version)
                    resolve(`[PDF Content: ${file.name}]\n[For full PDF text extraction, please use a dedicated PDF library]`);
                } else {
                    reader.readAsText(file);
                }
            });
        }

        // ==================== URL FETCHER ====================
        async function fetchURL() {
            const urlInput = document.getElementById('urlInput').value.trim();
            
            if (!urlInput) {
                showError('Please enter a URL');
                return;
            }

            if (!isValidUrl(urlInput)) {
                showError('Please enter a valid URL (include http:// or https://)');
                return;
            }

            const btn = document.getElementById('fetchUrlBtn');
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Fetching...';

            try {
                // Use CORS proxy (free public proxy)
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                const response = await fetch(proxyUrl + urlInput, {
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const html = await response.text();
                const text = extractTextFromHTML(html);
                
                if (text.trim().length < 100) {
                    throw new Error('Could not extract meaningful text from the URL');
                }
                
                // Insert into suspicious text area
                document.getElementById('suspiciousText').value = text;
                updateTextStats();
                showSuccess('Text fetched successfully!');
                
            } catch (error) {
                showError(`Failed to fetch URL: ${error.message}`);
                
                // Fallback: Use placeholder text
                document.getElementById('suspiciousText').value = 
                    `[Sample text from URL: ${urlInput}]\n\n` +
                    `Due to CORS restrictions, direct URL fetching is limited.\n` +
                    `Please copy-paste the text manually or use the file upload feature.`;
                updateTextStats();
            } finally {
                btn.disabled = false;
                btn.innerHTML = '<i class="fas fa-download"></i> Fetch';
            }
        }

        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        function extractTextFromHTML(html) {
            // Create a temporary DOM element
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            
            // Remove script and style elements
            const scripts = tempDiv.getElementsByTagName('script');
            const styles = tempDiv.getElementsByTagName('style');
            
            while (scripts[0]) {
                scripts[0].parentNode.removeChild(scripts[0]);
            }
            
            while (styles[0]) {
                styles[0].parentNode.removeChild(styles[0]);
            }
            
            // Get text content
            let text = tempDiv.textContent || tempDiv.innerText || '';
            
            // Clean up the text
            text = text.replace(/\s+/g, ' ').trim();
            text = text.replace(/[ \t]+/g, ' ');
            text = text.replace(/\n\s*\n/g, '\n\n');
            
            return text.substring(0, 10000); // Limit to 10000 chars
        }

        // ==================== SEARCH SUGGESTIONS ====================
        function showSuggestions() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const dropdown = document.getElementById('suggestionsDropdown');
            
            if (input.length < 2) {
                dropdown.classList.remove('active');
                return;
            }
            
            const filtered = commonPhrases.filter(phrase => 
                phrase.toLowerCase().includes(input)
            ).slice(0, 5);
            
            if (filtered.length === 0) {
                dropdown.classList.remove('active');
                return;
            }
            
            dropdown.innerHTML = filtered.map(phrase => `
                <div class="suggestion-item" onclick="selectSuggestion('${phrase}')">
                    <i class="fas fa-search" style="color: var(--text-light); margin-right: 10px;"></i>
                    ${phrase}
                </div>
            `).join('');
            
            dropdown.classList.add('active');
        }

        function selectSuggestion(phrase) {
            document.getElementById('searchInput').value = phrase;
            document.getElementById('suggestionsDropdown').classList.remove('active');
            
            // Add to text area
            const suspiciousText = document.getElementById('suspiciousText');
            suspiciousText.value += (suspiciousText.value ? '\n\n' : '') + phrase;
            updateTextStats();
        }

        // ==================== TEXT STATS ====================
        function debounceUpdateStats() {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(updateTextStats, 300);
        }

        function updateTextStats() {
            // Original text stats
            const originalText = document.getElementById('originalText').value;
            const originalWords = countWords(originalText);
            const originalChars = originalText.length;
            const originalSentences = countSentences(originalText);
            
            document.getElementById('originalWordCount').textContent = originalWords;
            document.getElementById('originalCharCount').textContent = originalChars;
            document.getElementById('originalSentenceCount').textContent = originalSentences;
            
            // Color coding
            document.getElementById('originalWordCount').style.color = 
                originalWords < 10 ? 'var(--danger)' : 
                originalWords < 30 ? 'var(--warning)' : 'var(--success)';

            // Suspicious text stats
            const suspiciousText = document.getElementById('suspiciousText').value;
            const suspiciousWords = countWords(suspiciousText);
            const suspiciousChars = suspiciousText.length;
            const suspiciousSentences = countSentences(suspiciousText);
            
            document.getElementById('suspiciousWordCount').textContent = suspiciousWords;
            document.getElementById('suspiciousCharCount').textContent = suspiciousChars;
            document.getElementById('suspiciousSentenceCount').textContent = suspiciousSentences;
            
            document.getElementById('suspiciousWordCount').style.color = 
                suspiciousWords < 10 ? 'var(--danger)' : 
                suspiciousWords < 30 ? 'var(--warning)' : 'var(--success)';
        }

        function countWords(text) {
            return text.trim().split(/\s+/).filter(w => w.length > 0).length;
        }

        function countSentences(text) {
            return text.split(/[.!?]+/).filter(s => s.trim().length > 0).length;
        }

        // ==================== PLAGIARISM DETECTION ====================
        class PlagiarismDetector {
            constructor() {
                this.commonPhrases = [
                    "in conclusion", "for example", "as a result", "on the other hand",
                    "in addition", "furthermore", "moreover", "however", "therefore",
                    "in summary", "to summarize", "overall", "it is important to",
                    "in order to", "due to the fact that", "based on the", "according to"
                ];
                
                this.synonyms = {
                    "good": ["excellent", "great", "superb", "fine"],
                    "bad": ["poor", "terrible", "awful", "horrible"],
                    "important": ["crucial", "vital", "essential", "significant"],
                    "big": ["large", "huge", "enormous", "massive"],
                    "small": ["tiny", "little", "miniature", "petite"]
                };
            }

            // Main detection function
            detectPlagiarism(originalText, suspiciousText, options = {}) {
                const ignoreSmallWords = options.ignoreSmallWords || true;
                const caseSensitive = options.caseSensitive || false;
                const checkWordOrder = options.checkWordOrder || false;

                // Prepare texts
                let text1 = caseSensitive ? originalText : originalText.toLowerCase();
                let text2 = caseSensitive ? suspiciousText : suspiciousText.toLowerCase();

                // Remove punctuation
                text1 = text1.replace(/[.,!?;:'"()]/g, '');
                text2 = text2.replace(/[.,!?;:'"()]/g, '');

                // Split into words
                let words1 = text1.split(/\s+/).filter(w => w.length > 0);
                let words2 = text2.split(/\s+/).filter(w => w.length > 0);

                // Filter small words if needed
                if (ignoreSmallWords) {
                    words1 = words1.filter(w => w.length >= 3);
                    words2 = words2.filter(w => w.length >= 3);
                }

                // Calculate similarity
                const totalUniqueWords = new Set([...words1, ...words2]).size;
                const commonWords = words1.filter(word => words2.includes(word));
                
                // Word similarity percentage
                let wordSimilarity = totalUniqueWords > 0 
                    ? (commonWords.length / totalUniqueWords) * 100 
                    : 0;

                // Check for phrase copying
                const phraseSimilarity = this.checkPhraseSimilarity(originalText, suspiciousText);
                
                // Check for word order patterns
                let orderSimilarity = 0;
                if (checkWordOrder && words1.length > 5 && words2.length > 5) {
                    orderSimilarity = this.checkWordOrderSimilarity(words1, words2);
                }

                // Final score (weighted average)
                const finalScore = Math.min(
                    (wordSimilarity * 0.6) + (phraseSimilarity * 0.3) + (orderSimilarity * 0.1),
                    100
                );

                // Find exact matches
                const exactMatches = this.findExactMatches(originalText, suspiciousText);
                
                // Check for common phrases
                const detectedPhrases = this.detectCommonPhrases(suspiciousText);

                // Generate highlights
                const highlights = options.enableHighlighting ? 
                    this.generateHighlights(originalText, suspiciousText, exactMatches) : 
                    { original: originalText, suspicious: suspiciousText };

                return {
                    score: Math.round(finalScore),
                    wordSimilarity: Math.round(wordSimilarity),
                    phraseSimilarity: Math.round(phraseSimilarity),
                    orderSimilarity: Math.round(orderSimilarity),
                    exactMatches: exactMatches,
                    commonPhrases: detectedPhrases,
                    originalWordCount: words1.length,
                    suspiciousWordCount: words2.length,
                    commonWordCount: commonWords.length,
                    highlights: highlights,
                    verdict: this.getVerdict(finalScore)
                };
            }

            generateHighlights(originalText, suspiciousText, exactMatches) {
                // Split into sentences
                const originalSentences = originalText.split(/[.!?]+/).filter(s => s.trim().length > 0);
                const suspiciousSentences = suspiciousText.split(/[.!?]+/).filter(s => s.trim().length > 0);
                
                let highlightedOriginal = originalText;
                let highlightedSuspicious = suspiciousText;
                
                // Highlight exact matches in red
                exactMatches.forEach(match => {
                    if (match.length > 20) {
                        const escapedMatch = match.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                        const regex = new RegExp(escapedMatch, 'gi');
                        highlightedSuspicious = highlightedSuspicious.replace(regex, 
                            `<span class="highlight-plagiarized">$&</span>`);
                    }
                });
                
                // Highlight common phrases
                this.commonPhrases.forEach(phrase => {
                    const regex = new RegExp(`\\b${phrase}\\b`, 'gi');
                    highlightedSuspicious = highlightedSuspicious.replace(regex,
                        `<span class="highlight-phrase">$&</span>`);
                });
                
                return {
                    original: highlightedOriginal,
                    suspicious: highlightedSuspicious
                };
            }

            checkPhraseSimilarity(text1, text2) {
                let similarity = 0;
                
                // Check for sentences
                const sentences1 = text1.split(/[.!?]+/).filter(s => s.trim().length > 10);
                const sentences2 = text2.split(/[.!?]+/).filter(s => s.trim().length > 10);
                
                if (sentences1.length === 0 || sentences2.length === 0) return 0;

                let matchedSentences = 0;
                sentences1.forEach(sentence => {
                    const cleanSentence = sentence.trim().toLowerCase();
                    if (cleanSentence.length < 15) return;
                    
                    sentences2.forEach(sentence2 => {
                        const cleanSentence2 = sentence2.trim().toLowerCase();
                        if (cleanSentence2.includes(cleanSentence) || 
                            cleanSentence.includes(cleanSentence2)) {
                            matchedSentences++;
                        }
                    });
                });

                similarity = (matchedSentences / Math.max(sentences1.length, sentences2.length)) * 100;
                return Math.min(similarity, 100);
            }

            checkWordOrderSimilarity(words1, words2) {
                // Simple n-gram comparison
                const n = 3; // Check 3-word sequences
                let matches = 0;
                let totalComparisons = 0;

                for (let i = 0; i <= words1.length - n; i++) {
                    const sequence1 = words1.slice(i, i + n).join(' ');
                    totalComparisons++;
                    
                    for (let j = 0; j <= words2.length - n; j++) {
                        const sequence2 = words2.slice(j, j + n).join(' ');
                        if (sequence1 === sequence2) {
                            matches++;
                            break;
                        }
                    }
                }

                return totalComparisons > 0 ? (matches / totalComparisons) * 100 : 0;
            }

            findExactMatches(text1, text2) {
                const matches = [];
                const sentences1 = text1.split(/[.!?]+/).filter(s => s.trim().length > 20);
                
                sentences1.forEach(sentence => {
                    const cleanSentence = sentence.trim();
                    if (cleanSentence.length > 30 && text2.includes(cleanSentence)) {
                        matches.push(cleanSentence);
                    }
                });

                return matches.slice(0, 5); // Return top 5 matches
            }

            detectCommonPhrases(text) {
                const foundPhrases = [];
                this.commonPhrases.forEach(phrase => {
                    const regex = new RegExp(`\\b${phrase}\\b`, 'gi');
                    if (regex.test(text)) {
                        foundPhrases.push(phrase);
                    }
                });
                return foundPhrases;
            }

            generateParaphrase(text) {
                // Simple paraphrasing by replacing synonyms
                let paraphrased = text;
                Object.keys(this.synonyms).forEach(word => {
                    const regex = new RegExp(`\\b${word}\\b`, 'gi');
                    const synonyms = this.synonyms[word];
                    if (synonyms && synonyms.length > 0) {
                        const randomSynonym = synonyms[Math.floor(Math.random() * synonyms.length)];
                        paraphrased = paraphrased.replace(regex, randomSynonym);
                    }
                });
                
                // Simple sentence restructuring patterns
                paraphrased = paraphrased.replace(/^(\w+)/, (match) => {
                    return 'It is worth noting that ' + match.toLowerCase();
                });
                
                return paraphrased;
            }

            getVerdict(score) {
                if (score >= 70) {
                    return {
                        level: 'danger',
                        title: 'High Plagiarism Detected',
                        message: 'Significant similarity found. This appears to be heavily copied content.',
                        suggestion: 'Rewrite the content in your own words.',
                        color: '#dc2626'
                    };
                } else if (score >= 40) {
                    return {
                        level: 'warning',
                        title: 'Moderate Similarity',
                        message: 'Some copying detected. Consider rephrasing similar sections.',
                        suggestion: 'Paraphrase the similar parts and add original insights.',
                        color: '#f59e0b'
                    };
                } else if (score >= 15) {
                    return {
                        level: 'good',
                        title: 'Low Similarity',
                        message: 'Minor similarities found. Mostly original content.',
                        suggestion: 'Good job! Consider adding more unique perspectives.',
                        color: '#16a34a'
                    };
                } else {
                    return {
                        level: 'excellent',
                        title: 'Very Original Content',
                        message: 'Minimal similarity detected. Content appears to be highly original.',
                        suggestion: 'Excellent! Your content is unique and original.',
                        color: '#3b82f6'
                    };
                }
            }
        }

        // ==================== WEB WORKER ====================
        function initializeWorker() {
            if (window.Worker) {
                const blob = new Blob([document.getElementById('workerScript').textContent]);
                plagiarismWorker = new Worker(URL.createObjectURL(blob));
                
                plagiarismWorker.onmessage = function(e) {
                    console.log('Worker result:', e.data);
                    // Handle worker results here
                };
            }
        }

        function processWithWorker(originalText, suspiciousText) {
            if (!plagiarismWorker) return null;
            
            return new Promise((resolve) => {
                plagiarismWorker.onmessage = function(e) {
                    resolve(e.data);
                };
                
                plagiarismWorker.postMessage({
                    originalText,
                    suspiciousText,
                    options: {
                        ignoreSmallWords: document.getElementById('ignoreSmallWords').checked,
                        caseSensitive: document.getElementById('caseSensitive').checked,
                        checkWordOrder: document.getElementById('checkWordOrder').checked
                    }
                });
            });
        }

        // ==================== MAIN FUNCTIONS ====================
        function initiateCheck() {
            // Check reCAPTCHA if enabled
            if (recaptchaLoaded && !window.grecaptcha.getResponse()) {
                showError('Please complete the reCAPTCHA verification');
                document.getElementById('recaptchaContainer').classList.add('active');
                return;
            }

            // Proceed with plagiarism check
            checkPlagiarism();
        }

        async function checkPlagiarism() {

            // Validation
            const originalText = document.getElementById('originalText').value.trim();
            const suspiciousText = document.getElementById('suspiciousText').value.trim();
            
             
            // Show loading
            document.getElementById('loadingSection').classList.add('active');
            document.getElementById('resultsSection').classList.remove('active');
            hideError();
            
            // Update progress
            updateProgress(0, 'Initializing...');

            // Get options
            const options = {
                ignoreSmallWords: document.getElementById('ignoreSmallWords').checked,
                caseSensitive: document.getElementById('caseSensitive').checked,
                checkWordOrder: document.getElementById('checkWordOrder').checked,
                enableHighlighting: document.getElementById('enableHighlighting').checked
            };

            try {
                // Use worker if available
                let results;
                if (plagiarismWorker) {
                    updateProgress(30, 'Processing with worker...');
                    results = await processWithWorker(originalText, suspiciousText);
                } else {
                    updateProgress(30, 'Analyzing texts...');
                    // Fallback to main thread
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    const detector = new PlagiarismDetector();
                    updateProgress(60, 'Calculating similarity...');
             try {
    results = detector.detectPlagiarism(originalText, suspiciousText, options);
} catch (error) {
    console.error("‚ùå DETECTOR ERROR:", error);
    results = {
        score: 0,
        wordSimilarity: 0,
        phraseSimilarity: 0,
        orderSimilarity: 0,
        exactMatches: [],
        commonPhrases: [],
        originalWordCount: originalText.trim().split(/\s+/).filter(w => w.length > 0).length,
suspiciousWordCount: suspiciousText.trim().split(/\s+/).filter(w => w.length > 0).length,
        commonWordCount: 0,
        highlights: { original: originalText, suspicious: suspiciousText },
        verdict: {
            level: 'good',
            title: 'Test Result',
            message: 'Testing mode',
            suggestion: 'Please check manually',
            color: '#16a34a'
        }
    };
}

                    results = detector.detectPlagiarism(originalText, suspiciousText, options);
                }
                
                updateProgress(90, 'Generating report...');
                displayResults(results);
                
                // Update stats
                updateTotalChecks();
                
                // Show paraphrasing suggestions if enabled
                if (document.getElementById('showParaphrasing').checked && results.score > 30) {
                    showParaphrasingSuggestions(results.exactMatches);
                }
                
                updateProgress(100, 'Complete!');
                
                // Hide loading, show results after a delay
                setTimeout(() => {
                    document.getElementById('loadingSection').classList.remove('active');
                    document.getElementById('resultsSection').classList.add('active');
                    scrollToResults();
                }, 500);
                
            } catch (error) {
                showError(`Analysis failed: ${error.message}`);
                document.getElementById('loadingSection').classList.remove('active');
            }
        }

        function updateProgress(value, text) {
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            if (progressBar) {
                progressBar.value = value;
                progressText.textContent = `${value}% - ${text}`;
            }
        }

        function validateInput(originalText, suspiciousText) {
    console.log("‚úÖ ValidateInput called!");  // YEH LINE ADD
    console.log("Original text:", originalText);  // YEH LINE ADD
    console.log("Suspicious text:", suspiciousText);  // YEH LINE ADD
    
    const originalWords = countWords(originalText);
    const suspiciousWords = countWords(suspiciousText);
    
    if (originalWords === 0 && suspiciousWords === 0) {
        showError('Please enter text in both boxes.');
        return false;
    }
               
            if (originalWords < 10) {
                showError('Original text should have at least 10 words for accurate results.');
                return false;
            }
            
            if (suspiciousWords < 10) {
                showError('Text to check should have at least 10 words.');
                return false;
            }
            
            return true;
        }

        function displayResults(results) {
if (!results.verdict) {
        results.verdict = {
            level: 'good',
            title: 'Analysis Complete',
            message: 'Plagiarism detection results',
            suggestion: 'Check your text for improvements',
            color: '#16a34a'
        };
    }

            // Update score display
            const scoreCircle = document.getElementById('scoreCircle');
            const resultTitle = document.getElementById('resultTitle');
            const resultDescription = document.getElementById('resultDescription');
            
            scoreCircle.textContent = results.score + '%';
            scoreCircle.className = 'score-circle score-good';
            scoreCircle.style.backgroundColor = '#16a34a';
            resultTitle.textContent = results.verdict?.title || 'Analysis Complete';
resultDescription.textContent = results.verdict?.message || 'Plagiarism detection results';

            // Update highlights in split view
            if (results.highlights) {
                document.getElementById('originalHighlighted').innerHTML = 
                    results.highlights.original.replace(/\n/g, '<br>');
                document.getElementById('suspiciousHighlighted').innerHTML = 
                    results.highlights.suspicious.replace(/\n/g, '<br>');
            }

            // Update chart
            updateChart(results);

            // Update detailed results
            const detailedResults = document.getElementById('detailedResults');
            let html = `
                <div style="margin-bottom: 20px;">
                    <h4 style="margin-bottom: 10px;">Analysis Summary</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 15px;">
                        <div style="background: var(--bg); padding: 10px; border-radius: 8px;">
                            <div style="font-size: 0.9rem; color: var(--text-light);">Word Similarity</div>
                            <div style="font-weight: 600; font-size: 1.2rem;">${results.wordSimilarity}%</div>
                        </div>
                        <div style="background: var(--bg); padding: 10px; border-radius: 8px;">
                            <div style="font-size: 0.9rem; color: var(--text-light);">Phrase Similarity</div>
                            <div style="font-weight: 600; font-size: 1.2rem;">${results.phraseSimilarity}%</div>
                        </div>
                        <div style="background: var(--bg); padding: 10px; border-radius: 8px;">
                            <div style="font-size: 0.9rem; color: var(--text-light);">Order Similarity</div>
                            <div style="font-weight: 600; font-size: 1.2rem;">${results.orderSimilarity}%</div>
                        </div>
                        <div style="background: var(--bg); padding: 10px; border-radius: 8px;">
                            <div style="font-size: 0.9rem; color: var(--text-light);">Common Words</div>
                            <div style="font-weight: 600; font-size: 1.2rem;">${results.commonWordCount}</div>
                        </div>
                    </div>
                    <div style="background: ${results.verdict?.color || '#16a34a'}20; 
                            padding: 15px; border-radius: 8px; margin-top: 10px; border-left: 4px solid ${results.verdict.color};">
                        <strong>üìã Recommendation:</strong> ${results.verdict.suggestion}
                    </div>
                </div>
            `;

            // Show exact matches if found
            if (results.exactMatches.length > 0) {
                html += `<div style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">üîç Exact Matches Found (${results.exactMatches.length})</h4>`;
                
                results.exactMatches.forEach((match, index) => {
                    html += `<div class="match-item" onclick="scrollToMatch('${match.substring(0, 50)}')">
                        <div style="font-size: 0.9rem; color: var(--danger); margin-bottom: 5px; display: flex; justify-content: space-between;">
                            <span>Match #${index + 1}</span>
                            <button class="btn btn-secondary" onclick="event.stopPropagation();paraphraseSentence('${match.replace(/'/g, "\\'")}')" style="padding: 2px 8px; font-size: 0.8rem;">
                                <i class="fas fa-lightbulb"></i> Paraphrase
                            </button>
                        </div>
                        <div style="font-size: 0.95rem;">"${match.substring(0, 150)}${match.length > 150 ? '...' : ''}"</div>
                    </div>`;
                });
                
                html += `</div>`;
            }

            // Show common phrases if found
            if (results.commonPhrases.length > 0) {
                html += `<div style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">üìù Common Phrases Detected</h4>
                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">`;
                
                results.commonPhrases.forEach(phrase => {
                    html += `<span style="background: var(--warning); color: white; padding: 4px 10px; border-radius: 15px; font-size: 0.85rem;">
                        ${phrase}
                    </span>`;
                });
                
                html += `</div></div>`;
            }

            detailedResults.innerHTML = html;
        }

        function updateChart(results) {
            const ctx = document.getElementById('similarityChart').getContext('2d');
            
            // Destroy existing chart if any
            if (chartInstance) {
                chartInstance.destroy();
            }
            
            chartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Similar Content', 'Unique Content'],
                    datasets: [{
                        data: [results.score, 100 - results.score],
                        backgroundColor: [
                            results.verdict.color,
                            '#e5e7eb'
                        ],
                        borderWidth: 0,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                color: 'var(--text)'      
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true
                    }
                }
            });
        }

        // ==================== PARAPHRASING ====================
        function showParaphrasingSuggestions(sentences) {
            const container = document.getElementById('paraphraseContainer');
            const suggestionsDiv = document.getElementById('paraphraseSuggestions');
            
            if (sentences.length === 0) {
                container.style.display = 'none';
                return;
            }
            
            const detector = new PlagiarismDetector();
            let html = '';
            
            sentences.slice(0, 3).forEach((sentence, index) => {
                const paraphrase = detector.generateParaphrase(sentence);
                html += `
                    <div class="paraphrase-item">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <strong>Suggestion ${index + 1}</strong>
                            <button class="btn btn-primary" onclick="useParaphrase('${paraphrase.replace(/'/g, "\\'")}')" style="padding: 2px 10px; font-size: 0.8rem;">
                                <i class="fas fa-copy"></i> Use
                            </button>
                        </div>
                        <div style="margin-bottom: 8px; font-size: 0.9rem; color: var(--text-light);">
                            <i class="fas fa-quote-left"></i> Original: "${sentence.substring(0, 100)}${sentence.length > 100 ? '...' : ''}"
                        </div>
                        <div style="background: var(--success); color: white; padding: 10px; border-radius: 8px;">
                            <i class="fas fa-lightbulb"></i> Paraphrased: ${paraphrase}
                        </div>
                    </div>
                `;
            });
            
            suggestionsDiv.innerHTML = html;
            container.style.display = 'block';
        }

        function paraphraseSentence(sentence) {
            const detector = new PlagiarismDetector();
            const paraphrase = detector.generateParaphrase(sentence);
            
            // Create a modal or alert with the paraphrase
            alert(`Original: ${sentence}\n\nParaphrased: ${paraphrase}\n\nClick OK to copy paraphrased version to clipboard.`);
            
            // Copy to clipboard
            navigator.clipboard.writeText(paraphrase).then(() => {
                showSuccess('Paraphrase copied to clipboard!');
            });
        }

        function useParaphrase(paraphrase) {
            const suspiciousText = document.getElementById('suspiciousText');
            suspiciousText.value = paraphrase;
            updateTextStats();
            showSuccess('Paraphrase applied to text area!');
        }

        // ==================== EXPORT FUNCTIONS ====================
        function downloadReport() {
            const score = document.getElementById('scoreCircle').textContent;
            const title = document.getElementById('resultTitle').textContent;
            const description = document.getElementById('resultDescription').textContent;
            
            const originalText = document.getElementById('originalText').value;
            const suspiciousText = document.getElementById('suspiciousText').value;
            
            const report = `
PLAGIARISM CHECK REPORT
${'='.repeat(50)}
Generated: ${new Date().toLocaleString()}
Tool: Plagiarism Checker Pro
Version: 2.0 Enhanced

OVERALL RESULTS:
${'='.repeat(50)}
Overall Similarity: ${score}
Result: ${title}
Description: ${description}

TEXT ANALYSIS:
${'='.repeat(50)}
- Original Text: ${countWords(originalText)} words, ${countSentences(originalText)} sentences
- Checked Text: ${countWords(suspiciousText)} words, ${countSentences(suspiciousText)} sentences

DETAILED FINDINGS:
${'='.repeat(50)}
${document.querySelector('#detailedResults')?.innerText || 'No detailed findings available'}

RECOMMENDATIONS:
${'='.repeat(50)}
${document.querySelector('#detailedResults strong')?.nextSibling?.textContent || 'No specific recommendation'}

ORIGINAL TEXT PREVIEW:
${'='.repeat(50)}
${originalText.substring(0, 500)}${originalText.length > 500 ? '...' : ''}

CHECKED TEXT PREVIEW:
${'='.repeat(50)}
${suspiciousText.substring(0, 500)}${suspiciousText.length > 500 ? '...' : ''}

${'='.repeat(50)}
Report generated by Offline Plagiarism Checker Pro
100% Private - No data was sent to any server
All processing done locally in your browser
            `;
            
            const blob = new Blob([report], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `plagiarism-report-${new Date().toISOString().slice(0,10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccess('Report downloaded successfully!');
        }

        async function exportAsPDF() {
            showError('PDF export requires additional libraries. Please use HTML or screenshot export.');
            // Note: Full PDF export would require PDF-Lib or similar library
            // This is a simplified placeholder
        }

        function exportAsHTML() {
            const resultsSection = document.getElementById('resultsSection');
            const htmlContent = `
<!DOCTYPE html>
<html>
<head>
    <title>Plagiarism Check Results</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .score { font-size: 3em; text-align: center; margin: 20px; }
        .result { padding: 20px; border-radius: 10px; margin: 20px 0; }
    </style>
</head>
<body>
    <h1>Plagiarism Check Results</h1>
    <div class="score">${document.getElementById('scoreCircle').textContent}</div>
    <h2>${document.getElementById('resultTitle').textContent}</h2>
    <p>${document.getElementById('resultDescription').textContent}</p>
    <div>${document.getElementById('detailedResults').innerHTML}</div>
    <p><small>Generated on ${new Date().toLocaleString()}</small></p>
</body>
</html>`;
            
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `plagiarism-results-${new Date().toISOString().slice(0,10)}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSuccess('HTML report exported!');
        }

        function takeScreenshot() {
            const resultsSection = document.getElementById('resultsSection');
            
            if (typeof html2canvas === 'undefined') {
                showError('Screenshot feature not loaded. Please refresh the page.');
                return;
            }
            
            html2canvas(resultsSection).then(canvas => {
                const link = document.createElement('a');
                link.download = `plagiarism-screenshot-${new Date().toISOString().slice(0,10)}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                showSuccess('Screenshot saved!');
            }).catch(error => {
                showError('Failed to take screenshot: ' + error.message);
            });
        }

        // ==================== UTILITY FUNCTIONS ====================
        function updateTotalChecks() {
            let checks = localStorage.getItem('plagiarismChecks') || 0;
            checks = parseInt(checks) + 1;
            localStorage.setItem('plagiarismChecks', checks);
            document.getElementById('totalChecks').textContent = checks;
        }

        function updateFileStats(increment = false) {
            if (increment) {
                let processed = localStorage.getItem('filesProcessed') || 0;
                processed = parseInt(processed) + 1;
                localStorage.setItem('filesProcessed', processed);
                document.getElementById('filesProcessed').textContent = processed;
            } else {
                document.getElementById('filesProcessed').textContent = 
                    localStorage.getItem('filesProcessed') || 0;
            }
        }

        function clearText() {
            document.getElementById('originalText').value = '';
            document.getElementById('suspiciousText').value = '';
            updateTextStats();
            hideError();
        }

        function clearAll() {
            clearText();
            clearFiles();
            document.getElementById('resultsSection').classList.remove('active');
            document.getElementById('loadingSection').classList.remove('active');
            document.getElementById('paraphraseContainer').style.display = 'none';
            document.getElementById('searchInput').value = '';
            document.getElementById('urlInput').value = '';
        }

        function checkAnother() {
            clearText();
            document.getElementById('resultsSection').classList.remove('active');
            document.getElementById('paraphraseContainer').style.display = 'none';
            scrollToTop();
        }

        function showError(message) {
        console.log("üî¥ ERROR SHOWING:", message);

            const errorElement = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            errorText.textContent = message;
            errorElement.classList.add('active');
            
            setTimeout(() => {
                hideError();
            }, 5000);
        }

        function showSuccess(message) {
            // Create temporary success message
            const successDiv = document.createElement('div');
            successDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--success);
                color: white;
                padding: 15px;
                border-radius: var(--border-radius);
                z-index: 10000;
                animation: slideInRight 0.3s ease;
            `;
            successDiv.innerHTML = `<i class="fas fa-check"></i> ${message}`;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }

        function hideError() {
            document.getElementById('errorMessage').classList.remove('active');
        }

        function scrollToResults() {
            document.getElementById('resultsSection').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function scrollToMatch(matchText) {
            const suspiciousHighlighted = document.getElementById('suspiciousHighlighted');
            const text = suspiciousHighlighted.textContent;
            const index = text.indexOf(matchText);
            
            if (index !== -1) {
                suspiciousHighlighted.scrollTop = (index / text.length) * suspiciousHighlighted.scrollHeight;
                suspiciousHighlighted.style.backgroundColor = 'rgba(255, 255, 0, 0.2)';
                setTimeout(() => {
                    suspiciousHighlighted.style.backgroundColor = '';
                }, 2000);
            }
        }

        function shareResults() {
            const score = document.getElementById('scoreCircle').textContent;
            const title = document.getElementById('resultTitle').textContent;
            
            const text = `üìä Plagiarism Check Results:
Similarity Score: ${score}
Result: ${title}

Checked using Plagiarism Checker Pro
(Advanced offline tool with file upload & highlighting)`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Plagiarism Check Results',
                    text: text
                });
            } else {
                navigator.clipboard.writeText(text).then(() => {
                    showSuccess('Results copied to clipboard!');
                });
            }
        }

        // ==================== COOKIE FUNCTIONS ====================
        function acceptCookies() {
            localStorage.setItem('cookiesAccepted', 'true');
            localStorage.setItem('cookieConsentDate', new Date().toISOString());
            document.getElementById('cookiePopup').classList.remove('active');
            showSuccess('Preferences saved!');
        }

        function declineCookies() {
            localStorage.setItem('cookiesAccepted', 'false');
            document.getElementById('cookiePopup').classList.remove('active');
        }

        // ==================== SAMPLE DATA ====================
        function generateSampleText() {
            const sampleOriginal = `Artificial intelligence (AI) is intelligence demonstrated by machines, as opposed to the natural intelligence displayed by animals including humans. Leading AI textbooks define the field as the study of "intelligent agents": any system that perceives its environment and takes actions that maximize its chance of achieving its goals. Some popular accounts use the term "artificial intelligence" to describe machines that mimic "cognitive" functions that humans associate with the human mind, such as "learning" and "problem solving".`;

            const sampleSuspicious = `Artificial intelligence refers to machine-based intelligence, contrasting with the biological intelligence seen in humans and animals. According to major AI textbooks, AI involves studying "intelligent agents"‚Äîsystems that observe their surroundings and act to improve their odds of reaching objectives. Many descriptions apply "artificial intelligence" to machines replicating "cognitive" abilities linked to human thinking, like "learning" and "solving problems".`;

            document.getElementById('originalText').value = sampleOriginal;
            document.getElementById('suspiciousText').value = sampleSuspicious;
            updateTextStats();
            showSuccess('Sample text loaded! Ready to check.');
        }

        // ==================== SECURITY FUNCTIONS ====================
        function sanitizeHTML(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ==================== EXTERNAL LINK PROTECTION ====================
        function protectExternalLinks() {
            document.querySelectorAll('a[href^="http"]').forEach(link => {
                if (!link.href.includes(window.location.hostname)) {
                    link.setAttribute('rel', 'noopener noreferrer nofollow');
                    link.setAttribute('target', '_blank');
                }
            });
        }

        // ==================== DATA LAYER ====================
        function pushDataLayer(event, data) {
            if (window.dataLayer) {
                window.dataLayer.push({
                    'event': event,
                    ...data
                });
            }
        }

        // ==================== INFO FUNCTIONS ====================
        function showPrivacyPolicy() {
            alert(`PRIVACY POLICY

1. No Data Collection
This tool runs 100% in your browser. No text you enter is sent to any server.

2. Local Storage
We use localStorage to save:
- Your theme preference (dark/light mode)
- Number of checks performed (for statistics)
- Cookie consent status

3. Cookies
We use one optional cookie for:
- Remembering your cookie consent choice

4. Third-Party Services
We load some external resources from CDNs:
- Font Awesome icons
- Chart.js for graphs
- html2canvas for screenshots

5. Your Rights
You can clear all stored data by:
- Using the Reset button
- Clearing browser storage
- Using incognito mode

For questions, please check the documentation.`);
        }

        function showTerms() {
            alert(`TERMS OF USE

1. Purpose
This tool is for educational and personal use to check text similarity.

2. Accuracy
Results are estimates based on algorithmic comparison. They should not be considered definitive proof of plagiarism.

3. Limitations
- Maximum file size: 5MB
- Supported formats: .txt, .doc, .docx, .pdf
- Text length: Limited by browser memory

4. Acceptable Use
You agree not to use this tool for:
- Illegal activities
- Harassment
- Copyright infringement
- Automated bulk checking

5. Disclaimer
This tool is provided "as is" without warranties. The developers are not responsible for any consequences of its use.

6. Open Source
The core algorithms are open for educational purposes.`);
        }

        function showInstructions() {
            alert(`INSTRUCTIONS

1. BASIC USAGE
- Paste text in both boxes OR upload files OR fetch from URL
- Adjust settings as needed
- Click "Check Plagiarism"

2. FILE UPLOAD
- Drag & drop files or click to browse
- Supported: .txt, .doc, .docx, .pdf
- Max size: 5MB per file

3. URL FETCHING
- Enter a complete URL (with http://)
- Works with most articles and blogs

4. HIGHLIGHTING
- Red: Plagiarized sentences
- Yellow: Partial matches
- Green: Unique content
- Dark red: Exact word matches
- Orange: Common phrases

5. EXPORT OPTIONS
- TXT Report: Detailed text report
- HTML Export: Interactive report
- Screenshot: Image of results
- Share: Copy results to clipboard

6. TIPS
- For best results, use texts with 100+ words
- Enable "Check word order" for more accuracy
- Use dark mode for reduced eye strain
- Clear cache if performance is slow

7. TROUBLESHOOTING
- Refresh page if features don't load
- Clear browser cache if slow
- Use latest Chrome/Firefox for best performance
- Check console (F12) for errors`);
        }

            </script>
</body>
</html>




